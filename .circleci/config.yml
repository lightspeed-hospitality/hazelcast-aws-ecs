version: 2.1

orbs:
  mvnlsk: development/mvnlsk@1.0.317

jobs:
  build-test:
    executor: mvnlsk/java-8
    steps:
      - mvnlsk/build
      - mvnlsk/test
  push:
    executor: mvnlsk/java-8
    steps:
      - mvnlsk/push:
          docker-deploy-goals: ""


workflows:
  version: 2
  workflow:
    jobs:
      - build-test:
          context: global
          filters:
            tags:
              only: /^[0-9]+[.][0-9]+[.][0-9]+$/
      - push:
          context: global
          requires:
            - build-test
          filters:
            branches:
              only:
                - main
            tags:
              only: /^[0-9]+[.][0-9]+[.][0-9]+$/
